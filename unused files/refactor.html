<html>
<body>
<svg style='background:#abcdef' id='lines'></svg>
<div id='output'></div>
	<script src='d3.v3.min.js'></script>	
	<script src='jquery-1.9.1.min.js'></script>	

	<script>
		window.array={};
		
		function fudge(routedir){
			var lastB= routedir.lastIndexOf('B');
			return routedir.substr(0,lastB+1);
		}


    	// LAT-LON MASTER CONVERTERS
    	function lonx(lon){
    		return (8823*lon)+1081060-4;
    	}
    	function laty(lat) {
	    	return 422405-(11164.4*lat);
    	}


		$.getJSON('stops.json',function(json) {
			//console.log(json);
			//go through all the route numbers
			for(var i=0;i<json['route'].length; i++) {
					window.name=json['route'][i]['-title'];
				
				//in each route number, go through all the headings
				for(var j=0; j<json['route'][i]['direction'].length; j++){
					window.routedir=fudge(json['route'][i]['direction'][j]['-tag']);
					window.title=json['route'][i]['direction'][j]['-title'];
					window.stops=json['route'][i]['direction'][j]['stop'];
					
					array[routedir]={"Path":[], "Title": title, "Name": name, "Stops":[]};
					
					//in each heading, go through all the stop tags
					for (var k=0; k<stops.length; k++) {
						array[routedir]["Stops"][k]= {"Tag": stops[k]['-tag']};	
						
						//find the corresponding tag in the 'stop' node to get lat, lon, and title
						for (var l=0; l<json['route'][i]['stop'].length; l++){
							window.stopindex;
							if (json['route'][i]['stop'][l]['-tag']==stops[k]['-tag']) {
								stopindex=l;
								break;
							}
						}
						
						//array[routedir]["Stops"][k]["Lat"]=json['route'][i]['stop'][stopindex]['-lat'];
						//array[routedir]["Stops"][k]["Lon"]=json['route'][i]['stop'][stopindex]['-lon'];
						array[routedir]["Stops"][k]["xpos"]=lonx(json['route'][i]['stop'][stopindex]['-lon']);		
						array[routedir]["Stops"][k]["ypos"]=laty(json['route'][i]['stop'][stopindex]['-lat']);						
		
						array[routedir]["Stops"][k]["Intersection"]=json['route'][i]['stop'][stopindex]['-title'];
					}	

					//Generate path data for each routedir
					var stoplist=array[routedir]["Stops"];
					var datalen=stoplist.length;
					var path;

					for(var m=0;m<datalen;m++) {

						if(m==0)
							{path='M';}

						else
							{path+=' L'}
						
						path+=stoplist[m]['xpos'];
						path+=' ';
						path+=stoplist[m]['ypos'];			
					}





				array[routedir]["Path"]=path;

				}
			}
			array['08X__IB']["Path"]="M1057.187,310.52l0.529,8.485l-17.734,3.685l-24.704,3.014l1.146,0.893l1.588,10.383l3.354,20.766l2.734,23.668l5.294,3.684l14.47,12.393l16.058,14.179l10.235,8.932l3.97,4.689l2.294,8.597l2.559,15.965l3.354,20.32l3.353,20.989l2.294,13.954l2.294,17.305l0.971,10.383l10.94,10.048l16.41,15.854l10.146,10.606l14.382,14.514l14.382,15.519l-19.676,20.542l-16.587,16.971l-20.116,19.983l-17.47,16.412l-6,3.351l-7.058,2.901l-4.059,3.796l-2.383,4.689l-1.146,7.033l0.44,4.466l1.677,5.247l7.94,16.747l1.765,6.252l3.706,49.012l-0.971,17.528l-1.412,6.363l-9.087,21.547l-1.765,7.592v4.354l1.94,8.597l6,9.713l12.176,11.276l3.705,4.578l2.118,3.906l1.411,3.908l0.795,3.572l2.734,37.849l-0.617,10.717l-17.382,72.012l-5.47,14.4l-16.146,26.46l-1.588,3.685l-2.646,9.266l-2.029,15.296l0.176,6.587l1.147,5.247l5.47,12.393l0.971,3.685l-0.882,4.577l-3.794,6.252l1.234,2.68l3.177,4.912l15.617,33.493l6.617,20.096l8.382,25.566l5.823,17.863l8.028,24.451l10.146,30.143l0.265,3.351l4.412,20.095l5.117,26.571l2.559,17.975l-1.323,4.242l-2.118,1.452l-4.588,2.344l-6.705,1.563l-5.117,0.781l-1.589,3.126l-1.059,7.48l0.971,1.229l-1.146,7.592l-3.177,3.125l0.529,1.675l-0.353,1.229l-4.853,2.344l-1.765,2.01l-6,13.062l-3,2.233l-33.88-11.388l-7.853-2.903l-16.058-5.47l-16.323-6.029l-16.764-5.693l-6.705-3.015l-5.382,16.746l-0.883,1.005l-13.587-3.461l-0.354-0.781l-6.264-0.669l-4.235,4.688l0.794,0.893l-0.794,12.616l-5.206,8.708l0.529,0.894l-5.028,13.731l-1.941,3.573l-26.558-8.485l-2.205-1.897l-6.088-4.354l-9.176-9.489l-4.147-2.791l-1.853,0.223l-22.322-11.388l-9.44-5.582l-32.381-7.927l-6.088-2.121l-19.763-9.937l-14.382-8.262l-17.822-10.159l-11.646-7.369l-0.794-1.34l-2.029-4.464l-3.354-4.467l-16.939-16.301l-13.94-15.295l-1.147,0.224l-17.381-8.82l-25.058-12.504l-15.97-8.597l-3.97-3.796l-2.823-4.242";						
					
			array['08X___OB']["Path"]="M656.27,1245.092l-2.471-0.559l-1.588,3.015l9.616,2.68l3.794,0.111l0.795,3.461l13.41,6.364l24.352,11.945l16.411,8.597l2.029,2.121l13.94,12.951l16.939,18.645l3.354,4.467l3.353,4.353l-0.265,1.005l14.116,7.48l11.206,6.363l17.558,9.937l18.352,10.271l2.117,2.121l16.94,3.462l21.528,6.586l10.323,4.131l16.939,8.819l6.353,3.797l4.147,2.791l9.176,9.489l6.088,4.354l1.146-0.67l20.205,8.373l5.117,0.894l3-0.334l5.117-16.972l1.059-0.223l2.383-3.238l2.382-4.354l-0.794-10.83l0.794-2.679l5.205-5.359l1.324,0.894l3.97,0.446l13.94,4.242l-0.441-1.228l4.941-14.178l1.765-2.346l9.264,2.567l16.499,5.694l16.499,5.806l23.91,8.484l29.116,10.271l2.294,1.675l3.971-8.039l5.029-7.256l3.705-3.35l1.588-1.675l1.324,0.671l-0.177-2.904l3.177-3.125l0.176-8.82l-0.265-3.685l2.118-5.806l2.293-1.786l3.618-0.111l5.734-2.903l5.559-1.004l2.118-1.452l1.323-4.242l-3.353-14.849l-4.941-26.013l-3.794-23.779l-2.646-4.69l-8.646-27.688l-4.5-13.732l-8.294-24.673l-9.264-28.916l-3.441-12.616l1.677-3.572l0.088-3.571l-24.439-53.478l-3.617-15.967l-1.059-10.829l2.999-21.882l0.795-2.456l22.763-41.644l15.882-63.637l3.529-23.11l-2.912-38.183l-2.117-7.033l-2.029-3.796l-15.617-15.631l-4.94-7.368l-1.323-2.902l-1.147-3.796l-0.882-5.136l-0.089-4.8l1.941-7.928l9.44-23.222l0.883-4.131l0.353-5.248l-4.853-61.068l-11.47-35.95l-0.089-8.708l3-13.397l2.559-5.806l17.117-18.31l19.587-19.649l2.559-1.339l-15.176-14.291l-10.323-10.271l-16.852-17.192l-12.528-13.621l-1.235-0.223l-2.471-4.913l-7.234,1.116l-5.735-31.93l-2.471-20.207l28.939-4.578l-1.588-5.806l-6.353-38.852l-3.441-21.659l-3.088-20.319l-3.97-23.333l0.353-2.233l-12.617-10.047l-8.293-8.263l3.176-0.446l-0.882-0.781l-2.735-17.194l-3.971-24.45l-2.646-17.193l0.353-2.903l15.528-3.126l21.882-3.461l6.088,1.898";		

			array['76X_OB']["Path"]="M1114.889,498.975l-32.733,5.359l-23.381,3.796l-14.558,2.344l-58.144,9.379l-55.32,8.931l-2.029,1.005l-7.323-54.816l-3.529-19.314l-7.588-47.896l-6-31.595L803.525,392.02l-73.849,12.281l-3.441-0.11l-19.675-17.195l-1.677-0.557l-3.882-4.132l-23.646-25.12l-3.177-4.466l-4.588-4.131l-3.441-2.12l-4.234-1.453l-4.588-0.781l-3.883,0.224l-3.176,0.669l-63.614,25.231l-6.97,1.005l-11.823-0.447l-73.495-21.101l-6.794-3.685l-7.059-5.693l-23.558-30.478l-1.764-0.671l-6.265-5.806l-6.353-8.596l-2.206-5.024l-1.146-4.019L419.548,47.709l-3.971-12.281l-5.028-5.247l-20.47-14.625l-6.176-5.807l-3.618-16.412l0.883-3.684v-0.558l-3.177,0.335l-5.823,4.8l-1.146,5.471l1.323,4.801l8.646,8.15l4.147,7.927l0.882,0.335l0.883,3.015l-1.589,4.577l-5.382,11.054l-0.882,8.708l0.44,2.902l5.647,5.583l0.705,2.679l-3.176,2.457l-3.177-0.782l-9.528,0.448l-6.882,7.144l-6.882-3.238l-2.471-2.901l0.441-13.845l-0.883-3.796l-1.588-2.009l-5.559-11.276l-2.912-2.01l-1.764-3.126l-4.323-4.019l-6.088,2.568l-3.441,0.893l-2.382-1.563l-2.383-1.005l-5.559,5.136l-2.646,0.223l-2.735-1.898l-5.029-9.043l-11.47-1.786l-2.294-1.563l-1.411,0.111l-3.266-10.16l-9.439-11.053l-6.529-5.917l-1.235-2.791l0.44-4.913l1.589-2.009l5.294-5.135l-1.235-3.127l-2.559-0.335l-3.529,4.801l-6.794,4.131l-0.353,7.035l0.97,2.901l-0.793,3.015l-6.617-1.228l-8.294-4.688l-3.441-0.895l-3.088,3.238l-1.411,4.466l-3,2.01l-8.823,0.111l-5.206-1.786l-6.352-5.359l1.588-3.015l-2.029-0.223l-3.617,0.781l-2.647,1.563l-3.618,3.572L194.562,13.1l-17.116,1.674l-16.764,7.257l-24.617,12.616l-9.529,2.344l-6.97,0.67l-12.97-2.01l-7.941-0.446l-4.676-1.897l-3.794-2.457l-2.382-2.68l-3.97-2.791l-11.47-3.684l-14.47-2.122l-12.617,0.224l-4.765,2.902L37.6,26.609l-6,10.606l1.765,3.573l0.529,3.238l-0.706,3.461l-3.353,3.238l-2.559,0.336l-4.147-0.671l-8.117-0.334l-3.882,0.669l-17.028,7.592l-2.029,3.349l0.882,2.456l1.412,2.122l2.294,0.335L2.22,72.83l3.529,2.679l1.588,2.345l-0.265,3.238L3.19,97.614l-2.294,2.01l-3.353,1.117l-11.205,0.111l-6.353,6.476l-4.059,3.014l-4.059,1.787l-0.441-0.894l-1.235,5.583l2.735,2.791l1.5,2.903l2.647,1.339l2.735,2.233l2.559,5.917l0.971,3.907l-1.235,4.466l-3.794,5.583l-1.765,1.004l5.559-6.587l1.235-4.466l-0.971-3.907l-1.765-4.131l-1.853-2.903l-4.323-2.456l-1.5-2.903l0.176-5.136l2.824-4.131l4.059-3.014l6.353-6.476l11.205-0.111l3.353-1.117l2.294-2.01l1.677-3.796l2.47-15.965l-1.588-2.345L2.22,72.83l-5.559-6.252l-3.706-2.457l-0.882-2.456l2.029-3.349l17.028-7.592l3.882-0.669l8.206,1.562l4.059-0.557l2.559-0.336l2.294-1.34l1.765-5.359l-0.529-3.238l-13.146,2.122l-6-1.005l-3.353-3.126l-2.206-4.913L5.308,28.73l-4.147-1.451l-3.088-0.335l-20.028,7.257l-8.735,0.447l-2.646-0.559l-13.853,1.229l-25.322,2.678l-5.206-1.675l1.412-4.242l5.294-5.583l-2.823,0.335l-25.234-4.131l-2.206,2.01l-1.412,4.466"				

			array['76X_IB']["Path"]="M-102.686,29.177l21.264,6.699l8.911,2.121l38.733-3.238l0.441-0.67l2.646,0.559l8.735-0.447l20.47-6.139l0.441-0.783l6.353,1.451l3.353,5.136l2.206,4.913l3.353,3.126l6,1.005l13.146-2.122l0.176-0.893L37.6,26.609l2.912-3.908l4.765-2.902l12.617-0.224l14.47,2.122l11.47,3.684l3.97,2.791l2.382,2.68l3.794,2.457l4.676,1.897l4.147,1.005l16.764,1.451l6.97-0.67l9.529-2.344l25.499-11.946l15.882-7.927l17.116-1.674l13.146-23.557l3.618-3.572l2.647-1.563l3.617-0.781l0.441,3.238l-0.795,0.558l7.146,4.801l5.206,1.786l8.823-0.111l3-2.01l1.411-4.466l3.088-3.238l3.441,0.895l8.294,4.688l4.764,2.009l2.646-3.796l-0.97-2.901l-0.618-4.802l6.176-4.688l3.177-5.248l4.5-0.894l1.235,3.127l-5.294,5.135l-1.589,2.009l-0.617,2.903l1.412,4.801l8.911,8.373l7.058,8.597l3.266,10.16l0.617,0.893l3.088,0.559l11.47,1.786l5.029,9.043l2.735,1.898l2.646-0.223l3.354-4.242l4.588,0.111l2.382,1.563l3.441-0.893l6.088-2.568l4.323,4.019l1.764,3.126l2.912,2.01l5.559,11.276l1.588,2.009l0.883,3.796l-0.441,13.845l2.471,2.901l4.853,3.573l8.911-7.479l5.117-0.113l7.588,0.447L383.727,62l1.5-1.116l-0.088-4.131l-5.647-5.583l-0.44-2.902l0.529-7.257l7.323-17.081l-0.883-3.015l-2.382,0.335l-2.647-8.597l-6.44-6.252l2.382-1.563l0.441-2.568l6.617,10.16l15.705,12.394l8.47,4.576l3.706,3.461l3.44,5.136l3.441,9.825l19.587,238.248l1.059,4.02l2.294,5.247l11.294,15.965l6.088,5.135l-0.441,0.894l21.264,24.115l5.559,4.466l6.705,3.908l6.088,2.568l69.525,19.315l11.999,0.445l7.059-0.893l51.791-17.751l5.911-1.228l2.735,0.223l13.059-1.674l6.528,1.005l5.382,2.567l4.235,3.573l10.146,13.062l15.528,15.072l24.087,18.088l3.441,0.11l72.349-10.383l102.258-17.751l3.883,29.92l8.558,53.478l4.5,27.799l9.265,52.808l1.059,0.335l74.995-11.945l44.292-7.257l17.116-2.791l20.47-3.796l-0.441-9.602l-2.735-11.276l17.205-2.232l11.823-2.456l1.146,9.378l-0.529,0.446"


			array['28_IB']["Path"]="M509.631,1442.813l0.177,7.368l-13.676,0.111l-1.677-64.977l-2.382-29.474l-1.5-5.024l-8.646-32.488l-1.323-3.015l-5.471-9.713l-13.676-16.523l-4.323-10.271l0.089-6.81l0.97-1.451l3.706-66.987l-0.353-42.201l-0.706-12.839l-1.5-29.027l-1.588-29.251l-1.147-20.765l-1.323-25.567l-0.971-20.319l-1.146-21.547l-0.883-15.966l-1.146-20.766l-1.147-20.877l-1.412-25.9l-0.882-15.632l-1.147-20.877l-1.059-20.878l-1.5-25.566l-1.411-15.965l-1.5-20.654l-1.412-19.872l-1.853-12.616l-1.235-3.237l-4.411-8.262l-0.971-2.791l-3.265-20.989l-8.559-19.649l-0.088-2.68l1.147-3.572l2.382-2.903l3.441-2.009l2.823-0.67l32.998-2.791l17.999,2.791l3.353-0.224l2.559-1.675l1.676-2.791l0.354-3.907l0.617-1.451l-2.823-41.644l-2.206-42.76l-2.734-41.531l-0.794-20.208l5.117-17.975l20.558-38.853l1.235-5.358l1.588-126.604l-2.118-4.354l-1.853-2.344l-1.853-1.787l-2.735-1.785l-17.822-4.802l-2.912-1.675l-15.616-18.086l-0.883-4.354l3.971-3.461l-0.882-4.577l-2.029-1.785h-2.912l-2.029,0.557l-8.734,7.48l1.235,2.457l4.323,3.795l3.529-0.67l3.353,1.34l17.293,20.766l5.559,4.466l6.705,3.908l6.088,2.568l69.525,19.315l11.999,0.445l7.059-0.893l51.791-17.751l5.911-1.228l2.735,0.223l13.059-1.674l6.528,1.005l5.382,2.567l4.235,3.573l10.146,13.062l15.528,15.072l24.087,18.088l3.441,0.11l14.116-1.115l29.204-4.579l29.028-4.689l44.203-8.373l-0.971-9.937l-3.971-21.324l-14.558,2.344l-0.088-4.242l-2.56-16.077l-0.794-1.117l12.44-2.344l1.147,0.669";

			array['28_OB']["Path"]="M836.876,333.518l6.705,40.304l2.647,11.723l-42.703,6.475l-28.499,3.796l-32.38,5.137l-12.97,3.349l-3.441-0.11l-19.675-17.195l-5.559-4.689l-23.646-25.12l-3.177-4.466l-4.588-4.131l-3.441-2.12l-4.234-1.453l-4.588-0.781l-3.883,0.224l-3.176,0.669l-63.614,25.231l-6.97,1.005l-11.823-0.447l-73.495-21.101l-6.794-3.685l-7.059-5.693l-16.852-20.543l-0.883-4.354l3.971-3.461l-0.882-4.577l-2.029-1.785h-2.912l-2.029,0.557l-8.734,7.48l1.235,2.457l4.323,3.795l3.529-0.67l3.353,1.34l17.293,20.766l5.559,4.466l14.47,9.044l2.559,2.455l2.205,3.014l1.324,2.457l1.323,3.574l0.529,2.566l-1.412,109.077l-1.499,8.373l-1.5,4.466l-19.058,34.274l-1.06,2.68l-3.882,14.625l-0.177,22.775l2.647,42.313l2.382,45.662l2.029,35.839l1.677,4.576l-1.059,2.903l-2.118,2.232l-2.823,0.894l-19.939-2.791l-32.998,2.791l-2.823,0.67l-3.441,2.009l-2.382,2.903l-1.147,3.572l0.088,2.68l9.353,22.329l2.471,18.31l0.971,2.791l4.411,8.262l1.235,3.237l0.088,10.718l0.795,18.979l1.764,25.455l1.412,16.188l1.5,22.998l0.794,18.645l1.412,25.679l1.146,20.766l1.147,20.766l1.146,21.213l1.147,20.431l0.971,15.63l1.059,21.101l0.882,21.101l1.323,25.455l0.971,16.077l1.941,33.604l0.882,19.761l1.235,17.975l-1.235,43.765l-1.765,68.661l0.706,7.368l4.323,10.271l15.528,24.674l3.618,1.562l-0.618,3.015l6.353,25.455l5.029,20.988l0.177,22.775l0.97,19.762l-3.528,26.348l-2.471,6.141l-4.146,20.654l-1.941,1.786l-4.5-0.67l-1.411-3.685l2.734-4.019l17.734-3.573l27.616-0.781l0.265-19.091l-4.146-0.224l-9.088,12.616";
			
			array['76X_OB']['Path']="M1114.889,498.975l-32.733,5.359l-23.381,3.796l-14.558,2.344l-58.144,9.379l-55.32,8.931l-2.029,1.005l-7.323-54.816l-3.529-19.314l-7.588-47.896l-6-31.596L803.525,392.02l-73.849,12.281l-3.441-0.11l-19.675-17.194l-1.677-0.558l-3.882-4.132l-23.646-25.12l-3.177-4.466l-4.588-4.131l-3.441-2.12l-4.234-1.452l-4.588-0.781l-3.883,0.225l-3.176,0.668l-63.614,25.231l-6.97,1.005l-11.823-0.446l-73.495-21.101l-6.794-3.685l-7.059-5.693l-23.558-30.478l-1.764-0.671l-6.265-5.806l-6.353-8.597l-2.206-5.024l-1.146-4.019L419.548,47.709l-3.971-12.281l-5.028-5.247l-20.47-14.625l-6.176-5.807l-3.617-16.412l0.882-3.684v-0.558l-3.176,0.335l-5.823,4.801l-1.147,5.47l1.323,4.801l8.646,8.15l4.147,7.927l0.882,0.335l0.882,3.015l-1.588,4.577l-5.382,11.054l-0.882,8.707l0.441,2.903l5.646,5.583l0.706,2.679l-3.176,2.457l-3.176-0.782l-9.529,0.448l-6.882,7.144l-6.882-3.238l-2.47-2.901l0.441-13.845l-0.882-3.796l-1.588-2.009l-5.559-11.276l-2.912-2.01l-1.765-3.126l-4.323-4.019l-6.088,2.568l-3.441,0.893l-2.382-1.563l-2.382-1.005l-5.558,5.136l-2.647,0.223l-2.735-1.898l-5.029-9.043l-11.47-1.786l-2.294-1.563l-1.412,0.112l-3.265-10.16l-9.44-11.053l-6.529-5.917l-1.235-2.791l0.441-4.913l1.588-2.009l5.294-5.135l-1.235-3.127l-2.559-0.335l-3.529,4.801l-6.794,4.131l-0.353,7.035l0.97,2.901l-0.794,3.015l-6.617-1.228l-8.293-4.688l-3.441-0.895l-3.088,3.238l-1.412,4.466l-3,2.01l-8.823,0.111l-5.206-1.786l-6.353-5.359l1.588-3.015l-2.029-0.223l-3.617,0.781l-2.647,1.563l-3.618,3.572L194.562,13.1l-17.117,1.674l-16.764,7.257l-24.616,12.616l-9.529,2.344l-6.97,0.67l-12.97-2.009l-7.941-0.447l-4.676-1.897l-3.794-2.457l-2.382-2.68l-3.97-2.791l-11.47-3.684l-14.47-2.122l-12.617,0.224l-4.765,2.902L37.6,26.609l-6,10.606l1.765,3.573l0.529,3.238l-0.706,3.461l-3.353,3.238l-2.559,0.336l-4.147-0.671l-8.117-0.334l-3.882,0.669l-17.028,7.592l-2.029,3.349l0.882,2.456l1.412,2.122l2.294,0.335L2.22,72.83l3.529,2.679l1.588,2.345l-0.265,3.238L3.19,97.614l-2.294,2.01l-3.353,1.117l-11.205,0.111l-6.353,6.476l-4.059,3.014l-4.059,1.787l-0.441-0.894l-1.235,5.583l2.735,2.791l1.5,2.903l2.647,1.339l2.735,2.233l2.559,5.917l0.971,3.907l-1.235,4.466l-3.794,5.583l-1.765,1.004l5.559-6.587l1.235-4.466l-0.971-3.907l-1.765-4.131l-1.853-2.903l-4.323-2.456l-1.5-2.903l0.176-5.136l2.824-4.131l4.059-3.014l6.353-6.476l11.205-0.111l3.353-1.117l2.294-2.01l1.677-3.796l2.47-15.965l-1.588-2.345L2.22,72.83l-5.559-6.252l-3.706-2.457l-0.882-2.456l2.029-3.349l17.028-7.592l3.882-0.669l8.206,1.562l4.059-0.557l2.559-0.336l2.294-1.34l1.765-5.359l-0.529-3.238l-13.146,2.122l-6-1.005l-3.353-3.126l-2.206-4.913L5.308,28.73l-4.147-1.451l-3.088-0.335l-20.028,7.257l-8.735,0.447l-2.646-0.559l-13.853,1.229l-25.322,2.678l-5.206-1.675l1.412-4.242l5.294-5.583l-2.823,0.335l-25.234-4.131l-2.206,2.01l-1.412,4.466"

			array['76X_IB']['Path']="M-102.686,29.177l21.264,6.699l8.911,2.121l38.733-3.238l0.441-0.67l2.646,0.559l8.735-0.447l20.469-6.139l0.441-0.783l6.353,1.451l3.353,5.136l2.206,4.913l3.353,3.126l6,1.005l13.146-2.122l0.176-0.893L37.6,26.609l2.912-3.908l4.765-2.902l12.617-0.224l14.47,2.122l11.47,3.684l3.97,2.791l2.382,2.68l3.794,2.457l4.676,1.897l4.147,1.005l16.764,1.451l6.97-0.67l9.529-2.344l25.499-11.946l15.881-7.927l17.117-1.674l13.146-23.557l3.618-3.572l2.647-1.563l3.617-0.781l0.441,3.238l-0.794,0.558l7.147,4.801l5.206,1.786l8.823-0.111l3-2.01l1.412-4.466l3.088-3.238l3.441,0.895l8.293,4.688l4.764,2.009l2.647-3.796l-0.97-2.901l-0.618-4.802l6.176-4.688l3.176-5.248l4.5-0.894l1.235,3.127l-5.294,5.135l-1.588,2.009l-0.618,2.903l1.412,4.801l8.911,8.373l7.058,8.597l3.265,10.16l0.618,0.893l3.088,0.559l11.47,1.786l5.029,9.043l2.735,1.898l2.647-0.223l3.353-4.242l4.588,0.111l2.382,1.563l3.441-0.893l6.088-2.568l4.323,4.019l1.765,3.126l2.912,2.01l5.559,11.276l1.588,2.009l0.882,3.796l-0.441,13.845l2.47,2.901l4.853,3.573l8.912-7.479l5.117-0.113l7.588,0.447L383.727,62l1.5-1.116l-0.088-4.131l-5.646-5.583l-0.441-2.903l0.529-7.257l7.323-17.081l-0.882-3.015l-2.382,0.335l-2.647-8.597l-6.44-6.252l2.382-1.563l0.441-2.568l6.617,10.16l15.705,12.394l8.47,4.576l3.706,3.461l3.44,5.136l3.441,9.825l19.587,238.248l1.059,4.02l2.294,5.247l11.294,15.965l6.088,5.136l-0.441,0.894l21.264,24.115l5.559,4.466l6.705,3.907l6.088,2.567l69.525,19.315l11.999,0.446l7.059-0.894l51.791-17.751l5.911-1.229l2.735,0.224l13.059-1.675l6.528,1.005l5.382,2.567l4.235,3.573l10.146,13.062l15.528,15.072l24.087,18.088l3.441,0.11l72.349-10.383l102.258-17.752l3.883,29.921l8.558,53.478l4.5,27.799l9.265,52.808l1.059,0.335l74.995-11.945l44.292-7.257l17.116-2.791l20.47-3.796l-0.441-9.602l-2.735-11.276l17.205-2.232l11.823-2.456l1.146,9.378l-0.529,0.446"
			//create branch for route paths
			array["RoutePaths"]={};
			
								
			for(var i=0;i<json['route'].length; i++) {
						var line=json['route'][i]['-tag'];
						//array["RoutePaths"][i]=line;
						array['RoutePaths'][line]={"Subsegments":[]};

						//within "path," iterate through all the segments and provide a variable to store the path data
						for(var j=0;j<json['route'][i]['path'].length;j++) {
							var segment=json['route'][i]['path'][j]["point"];
							var pathdata;
							
							//within each segment, iterate through all the lat-lon pairs, convert to x-y, and construct a string with them
							for(var k=0;k<segment.length;k++){

								if(k==0){
									pathdata='M';
								}

								else	{pathdata+=' L'}
								pathdata+=lonx(segment[k]['-lon']);
								pathdata+=' ';
								pathdata+=laty(segment[k]['-lat']);
							}
							array['RoutePaths'][line]['Subsegments'][j]=pathdata;
						}

			}

		


		//text replaces
		var outputtext=JSON.stringify(array);
		var edited= outputtext
					//.replace(/Ave./g,'Ave')
					.replace(/OWL/g,'OWL_')
					.replace(/ th /g,'th ')
					.replace(/___/g, '_')
					.replace(/__/g, '_')
					.replace(/Us Post/g, 'US Post')
					.replace(/St. /g, 'St ')
					.replace(/St." /g, 'St" ')
					.replace(/"0/g,'"')
					.replace(/'S/,"'s");			
		$('#output').text(edited);
		})	
	
	function givemeline(line){
		var segmentquant=array['RoutePaths'][line]['Subsegments'];
		//console.log(segmentquant);
		for(var i=0;i<segmentquant.length; i++){
			d3.select('svg').append('path').attr('d',segmentquant[i]).attr('fill','none').attr('stroke','black');
		}
	}
	</script>
</body>

</html>